<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Binary classification: Sentiment Analysis for User Reviews
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Library for the FSharp friendly usage of the ML.NET project"/>
    <meta name="author" content="Timo MÃ¼hlhaus"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11" >
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/FSharpML/content/style.css" /> <!--/FSharpML-->
    <link type="text/css" rel="stylesheet" href="/FSharpML/style/CSBstyles.css" /> <!--/FSharpML-->
    <script type="text/javascript" src="/FSharpML/content/tips.js"></script> <!--/FSharpML-->
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/CSBiology/FSharpML">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/FSharpML/index.html">FSharpML</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Binary-classification-Sentiment-Analysis-for-User-Reviews" class="anchor" href="#Binary-classification-Sentiment-Analysis-for-User-Reviews">Binary classification: Sentiment Analysis for User Reviews</a></h1>
<table>
<thead>
<tr class="header">
<th><p>ML.NET version</p></th>
<th><p>API type</p></th>
<th><p>Status</p></th>
<th><p>App Type</p></th>
<th><p>Data type</p></th>
<th><p>Scenario</p></th>
<th><p>ML Task</p></th>
<th><p>Algorithms</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>v0.10</p></td>
<td><p>Dynamic API</p></td>
<td><p>README.md updated</p></td>
<td><p>Console app</p></td>
<td><p>.tsv files</p></td>
<td><p>Sentiment Analysis</p></td>
<td><p>Two-class  classification</p></td>
<td><p>Linear Classification</p></td>
</tr>
</tbody>
</table>

<p>In this introductory sample, you'll see how to use FSharpML on top of <a href="https://www.microsoft.com/net/learn/apps/machine-learning-and-ai/ml-dotnet">ML.NET</a> to predict a sentiment (positive or negative) for customer reviews. In the world of machine learning, this type of prediction is known as <strong>binary classification</strong>.</p>
<h2><a name="Problem" class="anchor" href="#Problem">Problem</a></h2>
<p>This problem is centered around predicting if a customer's review has positive or negative sentiment. We will use wikipedia-detox-datasets (one dataset for training and a second dataset for model's accuracy evaluation) that were processed by humans and each comment has been assigned a sentiment label:</p>
<p>0 - negative
1 - positive</p>
<p>Using those datasets we will build a model that will analyze a string and predict a sentiment value of 0 or 1.</p>
<h2><a name="ML-task-Binary-classification" class="anchor" href="#ML-task-Binary-classification">ML task - Binary classification</a></h2>
<p>The generalized problem of <strong>binary classification</strong> is to classify items into one of two classes classifying items into more than two classes is called multiclass classification.</p>
<ul>
<li>predict if an insurance claim is valid or not.</li>
<li>predict if a plane will be delayed or will arrive on time.</li>
<li>predict if a face ID (photo) belongs to the owner of a device.</li>
</ul>
<p>The common feature for all those examples is that the parameter we want to predict can take only one of two values. In other words, this value is represented by <code>boolean</code> type.</p>
<h2><a name="Solution" class="anchor" href="#Solution">Solution</a></h2>
<p>To solve this problem, first we will build an ML model. Then we will train the model on existing data, evaluate how good it is, and lastly we'll consume the model to predict a sentiment for new reviews.</p>
<ol>
<li>
Build and train the model
----------------------------
</li>
</ol>
<p>FSharpML containing two complementary parts named EstimatorModel and TransformerModel covering the full machine lerarning workflow. In order to build an ML model and fit it to the training data we use EstimatorModel.
The 'fit' function in EstimatorModel applied on training data results into the TransformerModel that represents the trained model able to transform other data of the same shape and is used int the second part to evaluate and consume the model.</p>
<p>Building a model includes:</p>
<ul>
<li><p>Define the data's schema maped to the datasets to read (<code>wikipedia-detox-250-line-data.tsv</code> and <code>wikipedia-detox-250-line-test.tsv</code>) with a DataReader</p></li>
<li><p>Create an Estimator and transform the data to numeric vectors so it can be used effectively by an ML algorithm (with <code>FeaturizeText</code>)</p></li>
<li><p>Choosing a trainer/learning algorithm (such as <code>FastTree</code>) to train the model with.</p></li>
</ul>
<p>*</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
<span class="l">51: </span>
<span class="l">52: </span>
<span class="l">53: </span>
<span class="l">54: </span>
<span class="l">55: </span>
<span class="l">56: </span>
<span class="l">57: </span>
<span class="l">58: </span>
<span class="l">59: </span>
<span class="l">60: </span>
<span class="l">61: </span>
<span class="l">62: </span>
<span class="l">63: </span>
<span class="l">64: </span>
<span class="l">65: </span>
<span class="l">66: </span>
<span class="l">67: </span>
<span class="l">68: </span>
<span class="l">69: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="pp">#load</span> <span class="s">&quot;../../FSharpML.fsx&quot;</span>


<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">System</span><span class="pn">;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="id">Microsoft</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="id">ML</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="id">Microsoft</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="id">ML</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="id">Data</span><span class="pn">;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="id">FSharpML</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="id">FSharpML</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="id">EstimatorModel</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs7', 12)" onmouseover="showTip(event, 'fs7', 12)" class="id">FSharpML</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">TransformerModel</span>


<span class="c">/// Type representing the text to run sentiment analysis on.</span>
<span class="pn">[&lt;</span><span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="rt">CLIMutable</span><span class="pn">&gt;]</span> 
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="rt">SentimentIssue</span> <span class="o">=</span> 
    <span class="pn">{</span> 
        <span class="pn">[&lt;</span><span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="rt">LoadColumn</span><span class="pn">(</span><span class="n">0</span><span class="pn">)</span><span class="pn">&gt;]</span>
        <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="id">Label</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs14', 18)" onmouseover="showTip(event, 'fs14', 18)" class="vt">bool</span>

        <span class="pn">[&lt;</span><span onmouseout="hideTip(event, 'fs12', 19)" onmouseover="showTip(event, 'fs12', 19)" class="rt">LoadColumn</span><span class="pn">(</span><span class="n">1</span><span class="pn">)</span><span class="pn">&gt;]</span>
        <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="id">Text</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="rt">string</span> 
    <span class="pn">}</span>

<span class="c">/// Result of sentiment prediction.</span>
<span class="pn">[&lt;</span><span onmouseout="hideTip(event, 'fs10', 22)" onmouseover="showTip(event, 'fs10', 22)" class="rt">CLIMutable</span><span class="pn">&gt;]</span>
<span class="k">type</span>  <span onmouseout="hideTip(event, 'fs17', 23)" onmouseover="showTip(event, 'fs17', 23)" class="rt">SentimentPrediction</span> <span class="o">=</span> 
    <span class="pn">{</span> 
        <span class="c">// ColumnName attribute is used to change the column name from</span>
        <span class="c">// its default value, which is the name of the field.</span>
        <span class="pn">[&lt;</span><span onmouseout="hideTip(event, 'fs18', 24)" onmouseover="showTip(event, 'fs18', 24)" class="rt">ColumnName</span><span class="pn">(</span><span class="s">&quot;PredictedLabel&quot;</span><span class="pn">)</span><span class="pn">&gt;]</span>
        <span onmouseout="hideTip(event, 'fs19', 25)" onmouseover="showTip(event, 'fs19', 25)" class="id">Prediction</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs14', 26)" onmouseover="showTip(event, 'fs14', 26)" class="vt">bool</span><span class="pn">;</span> 

        <span class="c">// No need to specify ColumnName attribute, because the field</span>
        <span class="c">// name &quot;Probability&quot; is the column name we want.</span>
        <span onmouseout="hideTip(event, 'fs20', 27)" onmouseover="showTip(event, 'fs20', 27)" class="id">Probability</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs21', 28)" onmouseover="showTip(event, 'fs21', 28)" class="vt">float32</span><span class="pn">;</span> 

        <span onmouseout="hideTip(event, 'fs22', 29)" onmouseover="showTip(event, 'fs22', 29)" class="id">Score</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs21', 30)" onmouseover="showTip(event, 'fs21', 30)" class="vt">float32</span> 
    <span class="pn">}</span>


<span class="c">//Create the MLContext to share across components for deterministic results</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 31)" onmouseover="showTip(event, 'fs23', 31)" class="id">mlContext</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 32)" onmouseover="showTip(event, 'fs24', 32)" class="rt">MLContext</span><span class="pn">(</span><span class="id">seed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 33)" onmouseover="showTip(event, 'fs25', 33)" class="vt">Nullable</span> <span class="n">1</span><span class="pn">)</span> <span class="c">// Seed set to any number so you</span>
                                             <span class="c">// have a deterministic environment</span>

<span class="c">// STEP 1: Common data loading configuration</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 34)" onmouseover="showTip(event, 'fs26', 34)" class="id">fullData</span> <span class="o">=</span> 
    <span class="k">__SOURCE_DIRECTORY__</span>  <span class="o">+</span> <span class="s">&quot;./data/wikipedia-detox-250-line-all.tsv&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs27', 35)" onmouseover="showTip(event, 'fs27', 35)" class="m">DataModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 36)" onmouseover="showTip(event, 'fs28', 36)" class="id">fromTextFileWith</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs11', 37)" onmouseover="showTip(event, 'fs11', 37)" class="rt">SentimentIssue</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs23', 38)" onmouseover="showTip(event, 'fs23', 38)" class="id">mlContext</span> <span class="s">&#39;\t&#39;</span> <span class="k">true</span> 

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 39)" onmouseover="showTip(event, 'fs29', 39)" class="id">trainingData</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs30', 40)" onmouseover="showTip(event, 'fs30', 40)" class="id">testingData</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs26', 41)" onmouseover="showTip(event, 'fs26', 41)" class="id">fullData</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs27', 42)" onmouseover="showTip(event, 'fs27', 42)" class="m">DataModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs31', 43)" onmouseover="showTip(event, 'fs31', 43)" class="m">BinaryClassification</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 44)" onmouseover="showTip(event, 'fs32', 44)" class="id">trainTestSplit</span> <span class="n">0.2</span> 
    



<span class="c">//STEP 2: Process data, create and train the model </span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 45)" onmouseover="showTip(event, 'fs33', 45)" class="id">model</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs34', 46)" onmouseover="showTip(event, 'fs34', 46)" class="m">EstimatorModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 47)" onmouseover="showTip(event, 'fs35', 47)" class="id">create</span> <span onmouseout="hideTip(event, 'fs23', 48)" onmouseover="showTip(event, 'fs23', 48)" class="id">mlContext</span>
    <span class="c">// Process data transformations in pipeline</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 49)" onmouseover="showTip(event, 'fs34', 49)" class="m">EstimatorModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs36', 50)" onmouseover="showTip(event, 'fs36', 50)" class="id">appendBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs37', 51)" onmouseover="showTip(event, 'fs37', 51)" class="id">mlc</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs37', 52)" onmouseover="showTip(event, 'fs37', 52)" class="fn">mlc</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 53)" onmouseover="showTip(event, 'fs38', 53)" class="id">Transforms</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 54)" onmouseover="showTip(event, 'fs39', 54)" class="id">Text</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs40', 55)" onmouseover="showTip(event, 'fs40', 55)" class="id">FeaturizeText</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs41', 56)" onmouseover="showTip(event, 'fs41', 56)" class="rt">DefaultColumnNames</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 57)" onmouseover="showTip(event, 'fs42', 57)" class="id">Features</span> <span class="pn">,</span> <span class="s">&quot;Text&quot;</span><span class="pn">)</span><span class="pn">)</span>
    <span class="c">// Create the model</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 58)" onmouseover="showTip(event, 'fs34', 58)" class="m">EstimatorModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs36', 59)" onmouseover="showTip(event, 'fs36', 59)" class="id">appendBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs37', 60)" onmouseover="showTip(event, 'fs37', 60)" class="id">mlc</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs37', 61)" onmouseover="showTip(event, 'fs37', 61)" class="fn">mlc</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs43', 62)" onmouseover="showTip(event, 'fs43', 62)" class="id">BinaryClassification</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs44', 63)" onmouseover="showTip(event, 'fs44', 63)" class="id">Trainers</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs45', 64)" onmouseover="showTip(event, 'fs45', 64)" class="id">FastTree</span><span class="pn">(</span><span class="id">labelColumn</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 65)" onmouseover="showTip(event, 'fs41', 65)" class="rt">DefaultColumnNames</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs46', 66)" onmouseover="showTip(event, 'fs46', 66)" class="id">Label</span><span class="pn">,</span> <span class="id">featureColumn</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 67)" onmouseover="showTip(event, 'fs41', 67)" class="rt">DefaultColumnNames</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 68)" onmouseover="showTip(event, 'fs42', 68)" class="id">Features</span><span class="pn">)</span><span class="pn">)</span>
    <span class="c">// Train the model</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs34', 69)" onmouseover="showTip(event, 'fs34', 69)" class="m">EstimatorModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs47', 70)" onmouseover="showTip(event, 'fs47', 70)" class="id">fit</span> <span onmouseout="hideTip(event, 'fs29', 71)" onmouseover="showTip(event, 'fs29', 71)" class="id">trainingData</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs48', 72)" onmouseover="showTip(event, 'fs48', 72)" class="id">Dataview</span>

<span class="c">// STEP3: Run the prediciton on the test data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 73)" onmouseover="showTip(event, 'fs49', 73)" class="id">predictions</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="id">model</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 75)" onmouseover="showTip(event, 'fs50', 75)" class="m">TransformerModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 76)" onmouseover="showTip(event, 'fs51', 76)" class="id">transform</span> <span onmouseout="hideTip(event, 'fs30', 77)" onmouseover="showTip(event, 'fs30', 77)" class="id">testingData</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs48', 78)" onmouseover="showTip(event, 'fs48', 78)" class="id">Dataview</span>
</code></pre></td>
</tr>
</table>
<ol>
<li>
Evaluate and consume the model
---------------------------------
</li>
</ol>
<p>TransformerModel is used to evaluate the model and make prediction on independant data.</p>
<p>*</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// STEP4: Evaluate accuracy of the model</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 79)" onmouseover="showTip(event, 'fs52', 79)" class="id">metrics</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs33', 80)" onmouseover="showTip(event, 'fs33', 80)" class="id">model</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs53', 81)" onmouseover="showTip(event, 'fs53', 81)" class="m">Evaluation</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs54', 82)" onmouseover="showTip(event, 'fs54', 82)" class="rt">BinaryClassification</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 83)" onmouseover="showTip(event, 'fs55', 83)" class="id">evaluateWith</span><span class="pn">(</span><span class="id">Label</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs41', 84)" onmouseover="showTip(event, 'fs41', 84)" class="rt">DefaultColumnNames</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs46', 85)" onmouseover="showTip(event, 'fs46', 85)" class="id">Label</span><span class="pn">,</span><span class="id">Score</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs41', 86)" onmouseover="showTip(event, 'fs41', 86)" class="rt">DefaultColumnNames</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs56', 87)" onmouseover="showTip(event, 'fs56', 87)" class="id">Score</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs30', 88)" onmouseover="showTip(event, 'fs30', 88)" class="id">testingData</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs48', 89)" onmouseover="showTip(event, 'fs48', 89)" class="id">Dataview</span>



<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 90)" onmouseover="showTip(event, 'fs57', 90)" class="id">sampleStatement</span> <span class="o">=</span> <span class="pn">{</span> <span class="id">Label</span> <span class="o">=</span> <span class="k">false</span><span class="pn">;</span> <span onmouseout="hideTip(event, 'fs58', 91)" onmouseover="showTip(event, 'fs58', 91)" class="id">Text</span> <span class="o">=</span> <span class="s">&quot;This is a very rude movie&quot;</span> <span class="pn">}</span>
<span class="c">// STEP5: Create prediction engine function related to the loaded trained model</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs59', 92)" onmouseover="showTip(event, 'fs59', 92)" class="fn">predict</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs50', 93)" onmouseover="showTip(event, 'fs50', 93)" class="m">TransformerModel</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs60', 94)" onmouseover="showTip(event, 'fs60', 94)" class="id">createPredictionEngine</span><span class="pn">&lt;</span><span class="id">_</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs11', 95)" onmouseover="showTip(event, 'fs11', 95)" class="rt">SentimentIssue</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs17', 96)" onmouseover="showTip(event, 'fs17', 96)" class="rt">SentimentPrediction</span><span class="pn">&gt;</span> <span onmouseout="hideTip(event, 'fs33', 97)" onmouseover="showTip(event, 'fs33', 97)" class="id">model</span>

<span class="c">// Score</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 98)" onmouseover="showTip(event, 'fs61', 98)" class="id">prediction</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs59', 99)" onmouseover="showTip(event, 'fs59', 99)" class="fn">predict</span> <span onmouseout="hideTip(event, 'fs57', 100)" onmouseover="showTip(event, 'fs57', 100)" class="id">sampleStatement</span>
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs2">namespace FSharp.Plotly</div>
<div class="tip" id="fs3">namespace System</div>
<div class="tip" id="fs4">namespace Microsoft</div>
<div class="tip" id="fs5">namespace Microsoft.ML</div>
<div class="tip" id="fs6">namespace Microsoft.ML.Data</div>
<div class="tip" id="fs7">module FSharpML</div>
<div class="tip" id="fs8">namespace FSharpML.EstimatorModel</div>
<div class="tip" id="fs9">namespace FSharpML.TransformerModel</div>
<div class="tip" id="fs10">Multiple items<br />type CLIMutableAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; CLIMutableAttribute<br /><br />--------------------<br />new : unit -&gt; CLIMutableAttribute</div>
<div class="tip" id="fs11">type SentimentIssue =<br />&#160;&#160;{Label: bool;<br />&#160;&#160;&#160;Text: string;}<br /><em><br /><br />&#160;Type representing the text to run sentiment analysis on.</em></div>
<div class="tip" id="fs12">Multiple items<br />type LoadColumnAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : columnIndex:int -&gt; LoadColumnAttribute + 2 overloads<br /><br />--------------------<br />LoadColumnAttribute(columnIndex: int) : LoadColumnAttribute<br />LoadColumnAttribute(columnIndexes: int []) : LoadColumnAttribute<br />LoadColumnAttribute(start: int, end: int) : LoadColumnAttribute</div>
<div class="tip" id="fs13">SentimentIssue.Label: bool</div>
<div class="tip" id="fs14">type bool = Boolean</div>
<div class="tip" id="fs15">Multiple items<br />SentimentIssue.Text: string<br /><br />--------------------<br />namespace System.Text</div>
<div class="tip" id="fs16">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />--------------------<br />type string = String</div>
<div class="tip" id="fs17">type SentimentPrediction =<br />&#160;&#160;{Prediction: bool;<br />&#160;&#160;&#160;Probability: float32;<br />&#160;&#160;&#160;Score: float32;}<br /><em><br /><br />&#160;Result of sentiment prediction.</em></div>
<div class="tip" id="fs18">Multiple items<br />type ColumnNameAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : name:string -&gt; ColumnNameAttribute<br />&#160;&#160;member Name : string<br /><br />--------------------<br />ColumnNameAttribute(name: string) : ColumnNameAttribute</div>
<div class="tip" id="fs19">SentimentPrediction.Prediction: bool</div>
<div class="tip" id="fs20">SentimentPrediction.Probability: float32</div>
<div class="tip" id="fs21">Multiple items<br />val float32 : value:&#39;T -&gt; float32 (requires member op_Explicit)<br /><br />--------------------<br />type float32 = Single<br /><br />--------------------<br />type float32&lt;&#39;Measure&gt; = float32</div>
<div class="tip" id="fs22">SentimentPrediction.Score: float32</div>
<div class="tip" id="fs23">val mlContext : MLContext</div>
<div class="tip" id="fs24">Multiple items<br />type MLContext =<br />&#160;&#160;new : ?seed:Nullable&lt;int&gt; * ?conc:int -&gt; MLContext<br />&#160;&#160;member BinaryClassification : BinaryClassificationCatalog<br />&#160;&#160;member Clustering : ClusteringCatalog<br />&#160;&#160;member CompositionContainer : CompositionContainer with get, set<br />&#160;&#160;member Data : DataOperationsCatalog<br />&#160;&#160;member Model : ModelOperationsCatalog<br />&#160;&#160;member MulticlassClassification : MulticlassClassificationCatalog<br />&#160;&#160;member Ranking : RankingCatalog<br />&#160;&#160;member Regression : RegressionCatalog<br />&#160;&#160;member Transforms : TransformsCatalog<br />&#160;&#160;...<br /><br />--------------------<br />MLContext(?seed: Nullable&lt;int&gt;,?conc: int) : MLContext</div>
<div class="tip" id="fs25">Multiple items<br />type Nullable =<br />&#160;&#160;static member Compare&lt;&#39;T&gt; : n1:Nullable&lt;&#39;T&gt; * n2:Nullable&lt;&#39;T&gt; -&gt; int<br />&#160;&#160;static member Equals&lt;&#39;T&gt; : n1:Nullable&lt;&#39;T&gt; * n2:Nullable&lt;&#39;T&gt; -&gt; bool<br />&#160;&#160;static member GetUnderlyingType : nullableType:Type -&gt; Type<br /><br />--------------------<br />type Nullable&lt;&#39;T (requires default constructor and value type and &#39;T :&gt; ValueType)&gt; =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : value:&#39;T -&gt; Nullable&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;member Equals : other:obj -&gt; bool<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetValueOrDefault : unit -&gt; &#39;T + 1 overload<br />&#160;&#160;&#160;&#160;member HasValue : bool<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;&#160;&#160;member Value : &#39;T<br />&#160;&#160;end<br /><br />--------------------<br />Nullable ()<br />Nullable(value: &#39;T) : Nullable&lt;&#39;T&gt;</div>
<div class="tip" id="fs26">val fullData : DataModel.DataModel&lt;obj&gt;</div>
<div class="tip" id="fs27">module DataModel<br /><br />from FSharpML</div>
<div class="tip" id="fs28">val fromTextFileWith&lt;&#39;Trow&gt; : mlc:MLContext -&gt; separatorChar:char -&gt; hasHeader:bool -&gt; path:string -&gt; DataModel.DataModel&lt;obj&gt;</div>
<div class="tip" id="fs29">val trainingData : DataModel.DataModel&lt;DataModel.TrainTestSplitInfo&gt;</div>
<div class="tip" id="fs30">val testingData : DataModel.DataModel&lt;DataModel.TrainTestSplitInfo&gt;</div>
<div class="tip" id="fs31">Multiple items<br />module BinaryClassification<br /><br />from FSharpML.DataModel<br /><br />--------------------<br />type BinaryClassification =<br />&#160;&#160;static member trainTestSplitWith : ?Testfraction:float * ?Stratification:string * ?Seed:uint32 -&gt; (DataModel&lt;&#39;a0&gt; -&gt; DataModel&lt;TrainTestSplitInfo&gt; * DataModel&lt;TrainTestSplitInfo&gt;)</div>
<div class="tip" id="fs32">val trainTestSplit : testfraction:float -&gt; dataModel:DataModel.DataModel&lt;&#39;a&gt; -&gt; DataModel.DataModel&lt;DataModel.TrainTestSplitInfo&gt; * DataModel.DataModel&lt;DataModel.TrainTestSplitInfo&gt;</div>
<div class="tip" id="fs33">val model : TransformerModel&lt;BinaryPredictionTransformer&lt;Internal.Internallearn.IPredictorWithFeatureWeights&lt;float32&gt;&gt;&gt;</div>
<div class="tip" id="fs34">Multiple items<br />module EstimatorModel<br /><br />from FSharpML.EstimatorModel<br /><br />--------------------<br />namespace FSharpML.EstimatorModel<br /><br />--------------------<br />type EstimatorModel&lt;&#39;a (requires &#39;a :&gt; ITransformer and reference type)&gt; =<br />&#160;&#160;{EstimatorChain: EstimatorChain&lt;&#39;a&gt;;<br />&#160;&#160;&#160;Context: MLContext;}</div>
<div class="tip" id="fs35">val create : mlContext:MLContext -&gt; EstimatorModel&lt;&#39;a&gt; (requires reference type and &#39;a :&gt; Core.Data.ITransformer)</div>
<div class="tip" id="fs36">val appendBy : transforming:(MLContext -&gt; #Core.Data.IEstimator&lt;&#39;c&gt;) -&gt; estimatorModel:EstimatorModel&lt;&#39;d&gt; -&gt; EstimatorModel&lt;&#39;c&gt; (requires &#39;c :&gt; Core.Data.ITransformer and reference type and &#39;d :&gt; Core.Data.ITransformer and reference type)</div>
<div class="tip" id="fs37">val mlc : MLContext</div>
<div class="tip" id="fs38">property MLContext.Transforms: TransformsCatalog</div>
<div class="tip" id="fs39">property TransformsCatalog.Text: TransformsCatalog.TextTransforms</div>
<div class="tip" id="fs40">(extension) TransformsCatalog.TextTransforms.FeaturizeText(outputColumnName: string,?inputColumnName: string,?advancedSettings: Action&lt;Transforms.Text.TextFeaturizingEstimator.Settings&gt;) : Transforms.Text.TextFeaturizingEstimator<br />(extension) TransformsCatalog.TextTransforms.FeaturizeText(outputColumnName: string, inputColumnNames: Collections.Generic.IEnumerable&lt;string&gt;,?advancedSettings: Action&lt;Transforms.Text.TextFeaturizingEstimator.Settings&gt;) : Transforms.Text.TextFeaturizingEstimator</div>
<div class="tip" id="fs41">type DefaultColumnNames =<br />&#160;&#160;static val Features : string<br />&#160;&#160;static val Label : string<br />&#160;&#160;static val GroupId : string<br />&#160;&#160;static val Name : string<br />&#160;&#160;static val Weight : string<br />&#160;&#160;static val Score : string<br />&#160;&#160;static val Probability : string<br />&#160;&#160;static val PredictedLabel : string<br />&#160;&#160;static val RecommendedItems : string<br />&#160;&#160;static val User : string<br />&#160;&#160;...</div>
<div class="tip" id="fs42">field DefaultColumnNames.Features: string = &quot;Features&quot;</div>
<div class="tip" id="fs43">property MLContext.BinaryClassification: BinaryClassificationCatalog</div>
<div class="tip" id="fs44">property BinaryClassificationCatalog.Trainers: BinaryClassificationCatalog.BinaryClassificationTrainers</div>
<div class="tip" id="fs45">(extension) BinaryClassificationCatalog.BinaryClassificationTrainers.FastTree(options: Trainers.FastTree.FastTreeBinaryClassificationTrainer.Options) : Trainers.FastTree.FastTreeBinaryClassificationTrainer<br />(extension) BinaryClassificationCatalog.BinaryClassificationTrainers.FastTree(?labelColumn: string,?featureColumn: string,?weights: string,?numLeaves: int,?numTrees: int,?minDatapointsInLeaves: int,?learningRate: float) : Trainers.FastTree.FastTreeBinaryClassificationTrainer</div>
<div class="tip" id="fs46">field DefaultColumnNames.Label: string = &quot;Label&quot;</div>
<div class="tip" id="fs47">val fit : data:Data.DataView.IDataView -&gt; estimatorModel:EstimatorModel&lt;&#39;a&gt; -&gt; TransformerModel&lt;&#39;a&gt; (requires &#39;a :&gt; Core.Data.ITransformer and reference type)</div>
<div class="tip" id="fs48">DataModel.DataModel.Dataview: Data.DataView.IDataView</div>
<div class="tip" id="fs49">val predictions : Data.DataView.IDataView</div>
<div class="tip" id="fs50">Multiple items<br />module TransformerModel<br /><br />from FSharpML.TransformerModel<br /><br />--------------------<br />namespace FSharpML.TransformerModel<br /><br />--------------------<br />type TransformerModel&lt;&#39;a (requires &#39;a :&gt; ITransformer and reference type)&gt; =<br />&#160;&#160;{TransformerChain: TransformerChain&lt;&#39;a&gt;;<br />&#160;&#160;&#160;Context: MLContext;}</div>
<div class="tip" id="fs51">val transform : data:Data.DataView.IDataView -&gt; transformerModel:TransformerModel&lt;&#39;b&gt; -&gt; Data.DataView.IDataView (requires &#39;b :&gt; Core.Data.ITransformer and reference type)</div>
<div class="tip" id="fs52">val metrics : CalibratedBinaryClassificationMetrics</div>
<div class="tip" id="fs53">module Evaluation<br /><br />from FSharpML.TransformerModel</div>
<div class="tip" id="fs54">Multiple items<br />module BinaryClassification<br /><br />from FSharpML.TransformerModel.Evaluation<br /><br />--------------------<br />type BinaryClassification =<br />&#160;&#160;static member evaluateNonCalibratedWith : ?Label:string * ?Score:string * ?PredictedLabel:string -&gt; (IDataView -&gt; TransformerModel&lt;&#39;a0&gt; -&gt; BinaryClassificationMetrics) (requires &#39;a0 :&gt; ITransformer and reference type)<br />&#160;&#160;static member evaluateWith : ?Label:string * ?Score:string * ?Probability:string * ?PredictedLabel:string -&gt; (IDataView -&gt; TransformerModel&lt;&#39;a&gt; -&gt; CalibratedBinaryClassificationMetrics) (requires &#39;a :&gt; ITransformer and reference type)</div>
<div class="tip" id="fs55">static member Evaluation.BinaryClassification.evaluateWith : ?Label:string * ?Score:string * ?Probability:string * ?PredictedLabel:string -&gt; (Data.DataView.IDataView -&gt; TransformerModel&lt;&#39;a&gt; -&gt; CalibratedBinaryClassificationMetrics) (requires &#39;a :&gt; Core.Data.ITransformer and reference type)</div>
<div class="tip" id="fs56">field DefaultColumnNames.Score: string = &quot;Score&quot;</div>
<div class="tip" id="fs57">val sampleStatement : SentimentIssue</div>
<div class="tip" id="fs58">namespace System.Text</div>
<div class="tip" id="fs59">val predict : (SentimentIssue -&gt; SentimentPrediction)</div>
<div class="tip" id="fs60">val createPredictionEngine : transformerModel:TransformerModel&lt;&#39;a&gt; -&gt; (&#39;input -&gt; &#39;predictionResult) (requires &#39;a :&gt; Core.Data.ITransformer and reference type and reference type and default constructor and reference type)</div>
<div class="tip" id="fs61">val prediction : SentimentPrediction</div>

        </div>
        <div class="span3">
          <img src="/FSharpML/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
              <li class="nav-header">FSharpML</li>
              <li><a href="/FSharpML/index.html">Home page</a></li>
              <li><a href="/FSharpML/tutorial.html">Tuturial</a></li>
              <li class="divider"></li>
              <li><a href="http://nuget.org/packages/FSharpML">Get Library via NuGet</a></li>
              <li><a href="https://github.com/CSBiology/FSharpML">Source Code on GitHub</a></li>
              <li><a href="/FSharpML/license.html">License</a></li>
              <li><a href="/FSharpML/release-notes.html">Release Notes</a></li>

              <li class="nav-header">Samples</li>
              <li><a href="/FSharpML/BinaryClass_SentimentAnalysis.html">Binary classification: sentiment analysis</a></li>
              <li><a href="/FSharpML/BinaryClass_SpamDetection.html">Binary classification: spam detection</a></li>
              

              

              <li><a href="/FSharpML/Regression_PricePrediction.html">Regression: price prediction</a></li>
              

              

              <li><a href="/FSharpML/Clustering_IrisFlowers.html">Clustering: iris flowers</a></li>
              


              <li class="nav-header">Documentation</li>
              <li><a href="/FSharpML/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="https://github.com/CSBiology/FSharpML"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
